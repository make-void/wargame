!!! Strict
%html{ html_attrs("en") }
  %head
    %title WarGame
    %link{ href: "/stylesheets/main.css", rel: "stylesheet" }
    %meta{ charset: "utf-8" }
    %meta{ :"http-equiv" => "X-UA-Compatible", content: "IE=edge,chrome=1" }
    %meta{ name: "description", content: "" }
    %meta{ name: "keywords", content: "" }    
    %meta{ name: "author", content: "" }    
    %meta{ name: "viewport", content: "width=device-width, initial-scale=1.0" }
    %script{ src: "/javascripts/vendor/modernizr.js", type: "text/javascript" }
    = yield :head
    -# %script{:src => "http://js.pusherapp.com/1.8/pusher.min.js", :type => "text/javascript"}
    -# %script{ src: "/javascripts/vendor/pusher.js" }
  %body{ class: body_class }
    #wrap
      #container
        %header
          #player &nbsp;
          %h1 
            = link_to "WarGame", "/"
            
        %nav
        #content
          = yield
        %footer
    
    - if self.is_on? "game#show"
      = render partial: "game/nav"
        
    #debug
      = yield :debug
      
    
    %script{ src: "/javascripts/vendor/jquery.js", type: "text/javascript" }
    %script{ src: "/javascripts/vendor/jquery-timers.js", type: "text/javascript" }
    %script{ src: "/javascripts/vendor/underscore.js", type: "text/javascript" }
    %script{ src: "/javascripts/vendor/backbone.js", type: "text/javascript" }

    //  TODO: choose haml-js or/and handlebars before production
    %script{ src: "/javascripts/vendor/haml.js", type: "text/javascript" }
    %script{ src: "/javascripts/vendor/handlebars.js", type: "text/javascript" }
    = yield :maps
    %script{ src: "/javascripts/vendor/gmaps-infobubble.js", type: "text/javascript" }
    %script{ src: "/javascripts/main.js", type: "text/javascript" }    
    %script
      var http_host = "#{request.env["HTTP_HOST"]}";
    = yield :end
    
    
    // templates    
    
    %script{ type: "text/template", id: "playerView-tmpl" }
      :plain
        %p 
          Welcome, 
          %span= name
    
    %script{ type: "text/template", id: "armyDialog-tmpl" }
      :plain
        .dialog.army
          %p.player.name= player.name
          .commands
            
          
    %script{ type: "text/template", id: "cityDialog-tmpl" }
      :plain
        .dialog.city
          %p.name= city.name
          %p.player= player.name
          %p.population 
            pop: 
            = city.pts
            
    %script{ type: "text/template", id: "city_structsDialog-tmpl" }
      :plain
        .dialog.city_structs
          %ul.structures
            :each struct in definitions
              %li
                %a.btn.upgrade{ href: "javascript:void(0)" } Upgrade
                %p.name
                  = struct.name
                  %span level:
                  %span.level 0
                %p.desc= struct.description
                :if struct.base_production
                  %p.prod
                    production:
                    %span= struct.base_production
                %div.cost
                  %p= struct.gold_cost
                  %img{ src: "/images/icons/gold.png"}
                  %p= struct.steel_cost
                  %img{ src: "/images/icons/steel.png"}
                  %p= struct.oil_cost
                  %img{ src: "/images/icons/oil.png"}
        
          
    %script{ type: "text/template", id: "city_unitsDialog-tmpl" }
      :plain
        .dialog.city_units
          %ul.units
            :each unit in definitions
              %li
                %a.btn.recruit{ href: "javascript:void(0)" } Recruit
                %p.name= unit.name
                %p.type= unit.unit_type
                %p.stats
                  attack: 
                  %span= unit.power
                  defense: 
                  %span= unit.defense
                  attack type:
                  %span= new AttackType(unit.attack_type).toString()
                %div.cost
                  %p= unit.gold_cost
                  %img{ src: "/images/icons/gold.png"}
                  %p= unit.steel_cost
                  %img{ src: "/images/icons/steel.png"}
                  %p= unit.oil_cost
                  %img{ src: "/images/icons/oil.png"}
                %p.movement
                  Moves at 
                  %span= unit.movement_speed
                  consuming 
                  %span= unit.movement_cost
                %p.transport
                  Transports
                  %span= unit.transport_capacity
                  units,
                  %span= unit.cargo_capacity
                  resources

          
    %script{ type: "text/template", id: "city_techsDialog-tmpl" }
      :plain
        .dialog.city_techs
          %ul.techs
            :each tech in definitions
              %li
                %a.btn.upgrade{ href: "javascript:void(0)" } Research
                %p.name= tech.name
                %p.desc= tech.description
                %div.cost
                  %p= tech.gold_cost
                  %img{ src: "/images/icons/gold.png"}
                  %p= tech.steel_cost
                  %img{ src: "/images/icons/steel.png"}
                  %p= tech.oil_cost
                  %img{ src: "/images/icons/oil.png"}

          
          
    %script{ type: "text/template", id: "armyActionsMenu-tmpl" }    
      .move 
        Move
      .attack
        Attack 
  
  
        